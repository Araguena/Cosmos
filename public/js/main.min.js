function membersListAutocomplete(){var a=document.getElementById("json-members-list"),b=document.getElementById("members-list"),c=new XMLHttpRequest;c.onreadystatechange=function(d){if(4==c.readyState)if(200==c.status){var e=JSON.parse(c.responseText);e.forEach(function(b){var c=document.createElement("option");c.value=b.firstName+" "+b.lastName,a.appendChild(c)}),b.placeholder="e.g. existing member name"}else b.placeholder="Could not load options"},b.placeholder="Loading options...",c.open("GET","/members",!0),c.send(),c.open("GET","/members",!0),c.send()}function onDocumentLoad(){function a(){for(var a=document.querySelector(".js-comment-filter-by-user"),b=document.querySelector(".js-comment-filter-by-year"),c=document.querySelector(".js-comment-filter-by-month"),d=a.value,e=b.value,f=parseInt(c.value),g=document.querySelectorAll(".commentContainer"),h=0;h<g.length;h++)console.log(g[h].getAttribute("data-comment-author")),g[h].getAttribute("data-comment-author")!=d&&"Name"!=d&&(g[h].style.display="none"),g[h].getAttribute("data-comment-year")!=e&&"Year"!=e&&(g[h].style.display="none"),g[h].getAttribute("data-comment-month")!=f&&0!=f&&(g[h].style.display="none")}function b(){for(var a=document.querySelectorAll(".commentContainer"),b=0;b<a.length;b++)a[b].hasAttribute("style")&&a[b].removeAttribute("style");var c=document.querySelector(".js-comment-filter-by-user"),d=document.querySelector(".js-comment-filter-by-year");commentDropdownFilterByMonth=document.querySelector(".js-comment-filter-by-month"),c.options[0].selected=!0,d.options[0].selected=!0,commentDropdownFilterByMonth.options[0].selected=!0,commentDropdownFilterByMonth.setAttribute("disabled","disabled")}function c(){var a=moment("2012-10-22"),b=document.querySelector(".js-comment-filter-by-user"),c=document.querySelector(".js-comment-filter-by-month"),d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==d.readyState)if(200==d.status){var a=JSON.parse(d.responseText);a.forEach(function(a){var c=document.createElement("option");c.value=a.name,c.innerHTML=a.name,b.appendChild(c)})}else console.log("Could not load options for filtering comments by name")},d.open("GET","/comments",!0),d.send();for(var e=document.querySelector(".js-comment-filter-by-year"),f=parseInt(a.format("YYYY")),g=parseInt(moment().format("YYYY")),h=f;h<=g;h++){var i=document.createElement("option");i.value=h,i.innerHTML=h,e.appendChild(i)}e.addEventListener("click",function(){"false"!=e.value?c.disabled=!1:c.disabled=!0})}function d(){var a=new XMLHttpRequest;a.addEventListener("load",e),a.addEventListener("error",f),a.open("GET","/comments"),a.send()}function e(){if(this.status>=200){var a=JSON.parse(this.responseText);a.forEach(function(a){h(a)})}else f()}function f(){alert("Could not retrieve existing comments")}function g(){alert("Could not send your data")}function h(a){var b=document.createElement("article");"undefined"!==a.image&&a.image||(a.image="styles/img/user.png");var c=moment(a.creationTime),d=c.format("MMMM D, YYYY"),e=c.format("HH:mm"),f=c.format("YYYY"),g=c.format("MM");b.setAttribute("data-id",a.id),b.setAttribute("data-comment-author",a.name),b.setAttribute("data-comment-year",f),b.setAttribute("data-comment-month",g),b.className="commentContainer",b.innerHTML="<img class='img-fluid img-circle' src='"+a.image+"'><header>Added by <span class='data-comment-author-name'>"+a.name+"</span><br> on "+d+" at "+e+"</header><p>"+a.message+"</p><footer><button class='delete-comment-btn'><i class='fa fa-times js-remove' aria-hidden='true'></i></button><button class='edit-comment-btn'><i class='fa fa-pencil js-edit-comment' aria-hidden='true'></i></button></footer>";var h=document.querySelector(".comments-list");h.insertBefore(b,h.firstChild)}function i(a){a.preventDefault(),console.log(a),j()}function j(){var a=new XMLHttpRequest;a.addEventListener("load",function(){console.log(this.responseText);var a=JSON.parse(this.responseText),b=q.name.value;console.log(b);for(var c=0;c<a.length;c++){console.log(a[c]);var d=a[c].firstName+" "+a[c].lastName;if(d==b){s=a[c].image,console.log(d,s);break}}k()}),a.addEventListener("error",function(){k()}),a.open("GET","/members"),a.send()}function k(){var a=new XMLHttpRequest,b={name:q.name.value,email:q.email.value,message:q.message.value,creationTime:moment(),image:s};return b.message=b.message.trim().replace(/(<([^>]+)>)/gi,""),""==b.message?(alert("Add your message"),!1):(b=JSON.stringify(b),a.addEventListener("load",l),a.addEventListener("error",g),a.open("POST","/comments"),a.setRequestHeader("Content-type","application/json"),void a.send(b))}function l(){function a(){var a="gmail",d="new_comment_added",e={name:"James",subject:"New comment added",emailBody:"A new comment has been added to Cosmos page",commentAuthorEmail:b.email,time:c};emailjs.send(a,d,e)}var b=JSON.parse(this.responseText);h(b);var c=moment(b.creationTime);a(),q.name.value="",q.email.value="",q.message.value=""}function m(a){var b=a.target;if(b.classList.contains("js-remove")){for(;b!=a.currentTarget&&(b=b.parentNode,!b.classList.contains("commentContainer")););var c=new XMLHttpRequest;c.addEventListener("load",function(){n(b)}),c.addEventListener("error",o),c.open("DELETE","/comments/"+b.getAttribute("data-id")),c.send()}}function n(a){r.removeChild(a)}function o(){alert("Could not delete the comment")}function p(a){var b=document.getElementById("commentEditBox"),c=document.querySelector(".closeDialogBtn"),d=document.querySelector(".js-send-new-cmnt-data");c.addEventListener("click",function(){b.style.display="none"}),window.addEventListener("click",function(a){a.target==b&&(b.style.display="none")});var e=a.target;if(e.classList.contains("js-edit-comment"))for(;e!=a.currentTarget&&(e=e.parentNode,!e.classList.contains("commentContainer")););var f=e.childNodes[2],g=e.childNodes[1].childNodes[1],h=document.querySelector("#commentEditBox form");h.commentAuthor.value=g.innerHTML,h.commentMessage.value=f.innerHTML,b.style.display="block",d.onclick=function(){b.style.display="none";var a=h.commentMessage.value,c={message:a};c=JSON.stringify(c);var d=new XMLHttpRequest;d.addEventListener("load",function(a){var b=JSON.parse(a.target.responseText),c=b.id,d="[data-id='"+c+"']",e=document.querySelectorAll(d)[0],f=e.querySelector("p");f.innerHTML=b.message}),d.addEventListener("error",function(){alert("Could not send updated comment data")}),d.open("PUT","/comments/"+e.getAttribute("data-id")),d.setRequestHeader("Content-type","application/json"),d.send(c)}}d(),c();var q=document.querySelector(".feedback-form form");q.addEventListener("submit",i);var r=document.querySelector(".comments-list");r.addEventListener("click",m),r.addEventListener("click",p);var s="styles/img/user.png",t=document.querySelector(".js-filter-comments");t.addEventListener("click",a);var u=document.querySelector(".js-display-all-comments");u.addEventListener("click",b)}function initialize(){var a=1e3;setTimeout(function(){var a={lat:49.85,lng:24.0166666667},b=new google.maps.Map(document.querySelector(".map-container"),{zoom:13,center:a,scrollwheel:!1,mapTypeId:"roadmap",styles:[{featureType:"water",stylers:[{color:"#193341"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#406D80"},{visibility:"on"}]},{featureType:"road.highway",stylers:[{color:"#194A57"}]},{featureType:"road.local",stylers:[{color:"#406D80"}]},{featureType:"administrative",elementType:"geometry",stylers:[{color:"#2C5A71"}]},{featureType:"landscape",stylers:[{color:"#2C5A71"}]},{featureType:"landscape.man_made",elementType:"labels.text.stroke",stylers:[{color:"#2C5A71"},{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"}]}]});new google.maps.Marker({position:a,map:b,title:"Main office in Lviv"})},a)}function topMenu(){function a(){"topnav"===d.className?d.className+=" responsive":d.className="topnav"}function b(a){var b=a.target;console.log(b),b.classList.contains("js-hide-menu")&&(d.className="topnav")}var c=document.getElementById("js-toggle-menu-button");c.addEventListener("click",a);var d=document.getElementById("myTopnav");d.addEventListener("click",b)}function onDocumentLoaded(){function a(){var a=new XMLHttpRequest;a.addEventListener("load",c),a.addEventListener("error",d),a.open("GET","/members"),a.send()}function b(){var a=event.target;if(a.classList.contains("js-send-mail-to-member")){for(;a!=event.currentTarget;)if(a=a.parentNode,a.classList.contains("team__member")){var b=a.getAttribute("data-member-id");break}var c=document.getElementById("sendEmailToMember"),d=document.querySelector(".closeEmailDialogBtn"),e=document.querySelector(".js-send-email");c.style.display="block",d.addEventListener("click",function(){c.style.display="none"}),window.addEventListener("click",function(a){a.target==c&&(c.style.display="none")});var f=new XMLHttpRequest;f.onreadystatechange=function(){if(4==f.readyState)if(200==f.status){var a=JSON.parse(f.responseText),b=a.email,c=document.querySelector(".js-send-to-email");c.value=b,c.placeholder=b}else alert("Could not load options for member email")},f.open("GET","/members/"+b,!0),f.send(),e.onclick=function(){var a=document.querySelector("#sendEmailToMember form"),b="sendgrid",d="member_contacted",e=moment(),e=e.format("MMMM D, YYYY"),f={emailAuthorName:a.emailAuthor.value,emailAuthorAddress:a.emailAuthorEmail.value,sendToMemberEmail:a.memberEmail.value,messageBody:a.emailBody.value,messageTime:e};emailjs.send(b,d,f),c.style.display="none"}}}function c(){if(this.status>=200){var a=JSON.parse(this.responseText);a.forEach(function(a){e(a)})}else d();k()}function d(){alert("Could not retrieve existing members")}function e(a){var b=document.createElement("div");b.classList.add("team__member"),b.innerHTML="<img class='img-fluid img-circle' src='"+a.image+"'><h3>"+a.firstName+"<br>"+a.lastName+"</h3><p>"+a.position+"</p><button class='send-mail-btn'><i class='fa fa-envelope js-send-mail-to-member' aria-hidden='true'></i></button><a class='link-to-fb' href='https://www.facebook.com' target='_blank'><i class='fa fa-facebook aria-hidden='true'></a>",b.setAttribute("data-member-id",a.id);var c=document.querySelector(".js-team");c.insertBefore(b,c.firstChild),l.memberFirstName.value="",l.memberLastName.value="",l.memberEmail.value="",l.memberGender[0].selected=!0}function f(){event.preventDefault(),g()}function g(){var a=l.memberGender.value,b=new XMLHttpRequest;b.addEventListener("load",h),b.addEventListener("error",function(){alert("Could not load image"),h()}),b.open("GET","https://randomuser.me/api/?gender="+a),b.setRequestHeader("Content-Type","application/json"),b.send()}function h(){var a=JSON.parse(this.responseText),b="styles/img/user.png",c=a.results[0].picture.large||b,d=new XMLHttpRequest,e=moment(),f={firstName:l.memberFirstName.value,lastName:l.memberLastName.value,email:l.memberEmail.value,gender:l.memberGender.value,position:"New member",creationTime:e,image:c};return""==l.memberFirstName.value||""==l.memberLastName.value||""==l.memberEmail.value?(alert("Provide your first name, last name, and email"),!1):(f=JSON.stringify(f),d.addEventListener("load",i),d.addEventListener("error",j),d.open("POST","/members"),d.setRequestHeader("Content-type","application/json"),void d.send(f))}function i(){function a(){var a="gmail",c="new_member_added",d={memberName:b.firstName+" "+b.lastName,memberEmail:b.email,memberAddedOn:b.creationTime,memberId:b.id};emailjs.send(a,c,d)}var b=JSON.parse(this.responseText);e(b),k(),a()}function j(){alert("Could not create member")}function k(){var a=0,b=new XMLHttpRequest;b.onreadystatechange=function(){if(4==this.readyState&&200==this.status)for(var b=JSON.parse(this.responseText),c=b.length,d=document.querySelector(".js-hours-diff").getAttribute("data-latest-hours"),e=moment(),f=0;f<b.length;f++){var g=moment(b[f].creationTime),h=e.diff(g,"hours");h<=d&&a++}var i=document.querySelector(".js-totalMemberCount");i.innerHTML=c;var j=document.querySelector(".js-latestMemberCount");j.innerHTML=a},b.open("GET","/members"),b.send()}a();var l=document.querySelector(".member-form form");l.addEventListener("submit",f);var m=document.querySelector(".js-team");m.addEventListener("click",b)}document.addEventListener("DOMContentLoaded",membersListAutocomplete),document.addEventListener("DOMContentLoaded",onDocumentLoad),document.addEventListener("DOMContentLoaded",initialize),document.addEventListener("DOMContentLoaded",topMenu),function(a,b,c,d){function e(b,c){var f=this;"object"==typeof c&&(delete c.refresh,delete c.render,a.extend(this,c)),this.$element=a(b),!this.imageSrc&&this.$element.is("img")&&(this.imageSrc=this.$element.attr("src"));var g=(this.position+"").toLowerCase().match(/\S+/g)||[];if(g.length<1&&g.push("center"),1==g.length&&g.push(g[0]),"top"!=g[0]&&"bottom"!=g[0]&&"left"!=g[1]&&"right"!=g[1]||(g=[g[1],g[0]]),this.positionX!=d&&(g[0]=this.positionX.toLowerCase()),this.positionY!=d&&(g[1]=this.positionY.toLowerCase()),f.positionX=g[0],f.positionY=g[1],"left"!=this.positionX&&"right"!=this.positionX&&(isNaN(parseInt(this.positionX))?this.positionX="center":this.positionX=parseInt(this.positionX)),"top"!=this.positionY&&"bottom"!=this.positionY&&(isNaN(parseInt(this.positionY))?this.positionY="center":this.positionY=parseInt(this.positionY)),this.position=this.positionX+(isNaN(this.positionX)?"":"px")+" "+this.positionY+(isNaN(this.positionY)?"":"px"),navigator.userAgent.match(/(iPod|iPhone|iPad)/))return this.imageSrc&&this.iosFix&&!this.$element.is("img")&&this.$element.css({backgroundImage:"url("+this.imageSrc+")",backgroundSize:"cover",backgroundPosition:this.position}),this;if(navigator.userAgent.match(/(Android)/))return this.imageSrc&&this.androidFix&&!this.$element.is("img")&&this.$element.css({backgroundImage:"url("+this.imageSrc+")",backgroundSize:"cover",backgroundPosition:this.position}),this;this.$mirror=a("<div />").prependTo("body");var h=this.$element.find(">.parallax-slider"),i=!1;0==h.length?this.$slider=a("<img />").prependTo(this.$mirror):(this.$slider=h.prependTo(this.$mirror),i=!0),this.$mirror.addClass("parallax-mirror").css({visibility:"hidden",zIndex:this.zIndex,position:"fixed",top:0,left:0,overflow:"hidden"}),this.$slider.addClass("parallax-slider").one("load",function(){f.naturalHeight&&f.naturalWidth||(f.naturalHeight=this.naturalHeight||this.height||1,f.naturalWidth=this.naturalWidth||this.width||1),f.aspectRatio=f.naturalWidth/f.naturalHeight,e.isSetup||e.setup(),e.sliders.push(f),e.isFresh=!1,e.requestRender()}),i||(this.$slider[0].src=this.imageSrc),(this.naturalHeight&&this.naturalWidth||this.$slider[0].complete||h.length>0)&&this.$slider.trigger("load")}function f(d){return this.each(function(){var f=a(this),g="object"==typeof d&&d;this==b||this==c||f.is("body")?e.configure(g):f.data("px.parallax")?"object"==typeof d&&a.extend(f.data("px.parallax"),g):(g=a.extend({},f.data(),g),f.data("px.parallax",new e(this,g))),"string"==typeof d&&("destroy"==d?e.destroy(this):e[d]())})}!function(){for(var a=0,c=["ms","moz","webkit","o"],d=0;d<c.length&&!b.requestAnimationFrame;++d)b.requestAnimationFrame=b[c[d]+"RequestAnimationFrame"],b.cancelAnimationFrame=b[c[d]+"CancelAnimationFrame"]||b[c[d]+"CancelRequestAnimationFrame"];b.requestAnimationFrame||(b.requestAnimationFrame=function(c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=b.setTimeout(function(){c(d+e)},e);return a=d+e,f}),b.cancelAnimationFrame||(b.cancelAnimationFrame=function(a){clearTimeout(a)})}(),a.extend(e.prototype,{speed:.2,bleed:0,zIndex:-100,iosFix:!0,androidFix:!0,position:"center",overScrollFix:!1,refresh:function(){this.boxWidth=this.$element.outerWidth(),this.boxHeight=this.$element.outerHeight()+2*this.bleed,this.boxOffsetTop=this.$element.offset().top-this.bleed,this.boxOffsetLeft=this.$element.offset().left,this.boxOffsetBottom=this.boxOffsetTop+this.boxHeight;var a=e.winHeight,b=e.docHeight,c=Math.min(this.boxOffsetTop,b-a),d=Math.max(this.boxOffsetTop+this.boxHeight-a,0),f=this.boxHeight+(c-d)*(1-this.speed)|0,g=(this.boxOffsetTop-c)*(1-this.speed)|0;if(f*this.aspectRatio>=this.boxWidth){this.imageWidth=f*this.aspectRatio|0,this.imageHeight=f,this.offsetBaseTop=g;var h=this.imageWidth-this.boxWidth;"left"==this.positionX?this.offsetLeft=0:"right"==this.positionX?this.offsetLeft=-h:isNaN(this.positionX)?this.offsetLeft=-h/2|0:this.offsetLeft=Math.max(this.positionX,-h)}else{this.imageWidth=this.boxWidth,this.imageHeight=this.boxWidth/this.aspectRatio|0,this.offsetLeft=0;var h=this.imageHeight-f;"top"==this.positionY?this.offsetBaseTop=g:"bottom"==this.positionY?this.offsetBaseTop=g-h:isNaN(this.positionY)?this.offsetBaseTop=g-h/2|0:this.offsetBaseTop=g+Math.max(this.positionY,-h)}},render:function(){var a=e.scrollTop,b=e.scrollLeft,c=this.overScrollFix?e.overScroll:0,d=a+e.winHeight;this.boxOffsetBottom>a&&this.boxOffsetTop<=d?(this.visibility="visible",this.mirrorTop=this.boxOffsetTop-a,this.mirrorLeft=this.boxOffsetLeft-b,this.offsetTop=this.offsetBaseTop-this.mirrorTop*(1-this.speed)):this.visibility="hidden",this.$mirror.css({transform:"translate3d(0px, 0px, 0px)",visibility:this.visibility,top:this.mirrorTop-c,left:this.mirrorLeft,height:this.boxHeight,width:this.boxWidth}),this.$slider.css({transform:"translate3d(0px, 0px, 0px)",position:"absolute",top:this.offsetTop,left:this.offsetLeft,height:this.imageHeight,width:this.imageWidth,maxWidth:"none"})}}),a.extend(e,{scrollTop:0,scrollLeft:0,winHeight:0,winWidth:0,docHeight:1<<30,docWidth:1<<30,sliders:[],isReady:!1,isFresh:!1,isBusy:!1,setup:function(){if(!this.isReady){var d=a(c),f=a(b),g=function(){e.winHeight=f.height(),e.winWidth=f.width(),e.docHeight=d.height(),e.docWidth=d.width()},h=function(){var a=f.scrollTop(),b=e.docHeight-e.winHeight,c=e.docWidth-e.winWidth;e.scrollTop=Math.max(0,Math.min(b,a)),e.scrollLeft=Math.max(0,Math.min(c,f.scrollLeft())),e.overScroll=Math.max(a-b,Math.min(a,0))};f.on("resize.px.parallax load.px.parallax",function(){g(),e.isFresh=!1,e.requestRender()}).on("scroll.px.parallax load.px.parallax",function(){h(),e.requestRender()}),g(),h(),this.isReady=!0}},configure:function(b){"object"==typeof b&&(delete b.refresh,delete b.render,a.extend(this.prototype,b))},refresh:function(){a.each(this.sliders,function(){this.refresh()}),this.isFresh=!0},render:function(){this.isFresh||this.refresh(),a.each(this.sliders,function(){this.render()})},requestRender:function(){var a=this;this.isBusy||(this.isBusy=!0,b.requestAnimationFrame(function(){a.render(),a.isBusy=!1}))},destroy:function(c){var d,f=a(c).data("px.parallax");for(f.$mirror.remove(),d=0;d<this.sliders.length;d+=1)this.sliders[d]==f&&this.sliders.splice(d,1);a(c).data("px.parallax",!1),0===this.sliders.length&&(a(b).off("scroll.px.parallax resize.px.parallax load.px.parallax"),this.isReady=!1,e.isSetup=!1)}});var g=a.fn.parallax;a.fn.parallax=f,a.fn.parallax.Constructor=e,a.fn.parallax.noConflict=function(){return a.fn.parallax=g,this},a(c).on("ready.px.parallax.data-api",function(){a('[data-parallax="scroll"]').parallax()})}(jQuery,window,document),document.addEventListener("DOMContentLoaded",onDocumentLoaded);